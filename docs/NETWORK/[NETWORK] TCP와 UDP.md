# [NETWORK] TCP와 UDP

:writing_hand: *Assembled by JiYoung-Kwon (2021-01-19)* 



#### :pushpin: 전송계층

* IP에 의해 전달되는 패킷의 오류를 검사하고 재전송 요구 등의 제어를 담당하는 계층
* TCP와 UDP는 TCP/IP의 전송계층에서 사용되는 프로토콜
  * IP 프로토콜을 기반으로 구현
  * 서로 다른 특징을 가짐

<br/>

## 1. TCP(Transmission Control Protocol)

* 전송을 제어하는 프로토콜(규약)

* 인터넷 상에서 데이터를 메세지의 형태로 보내기 위해 IP와 함께 사용하는 프로토콜

* **신뢰성을 보장하는 연결형 서비스**

* 네트워크에 연결된 컴퓨터에서 실행되는 프로그램 간에, 일련의 옥텟(데이터, 메세지, 세그먼트라는 블록단위)를 **안정적으로, 순서대로, 에러없이** 교환할 수 있게 함

* 전화 통화하는 방식과 유사

* 특징

  > * **연결형 서비스**로 가상 회선 방식을 제공
  >   * 3-way handshaking 과정을 통해 연결을 설정
  >   * 4-way handshaking을 통해 연결을 해제
  >   * <img src = https://t1.daumcdn.net/cfile/tistory/991BEB3359FEB5712F width = 50%>
  > * 흐름 제어(Flow control)
  >   * 데이터 처리 속도를 조절하여 수신자의 버퍼 오버플로우 방지
  >
  > * 혼잡 제어(Congestion control)
  >
  >   * 네트워크 내의 패킷 수가 넘치게 증가하지 않도록 방지
  >
  > * **높은 신뢰성 보장**
  >
  >   * Dupack-based retransmission
  >
  >     - 정상적인 상황에서는 ACK 값이 연속적으로 전송되어야 함
  >     - ACK값이 중복으로 올 경우 패킷 이상을 감지하고 재전송을 요청
  >
  >   * Timeout-based retransmission
  >
  >     - 일정시간동안 ACK 값이 수신을 못할 경우 재전송을 요청
  >
  >       ![img](https://t1.daumcdn.net/cfile/tistory/22365B4E575868A80F)
  >
  > * 전이중, 점대점 방식
  >
  >   * 전이중(Full-Duplex)
  >     * 전송이 양방향으로 동시에 일어날 수 있음
  >   * 점대점(Point to Point)
  >     * 각 연결이 정확히 2개의 종단점을 가지고 있음
  >
  > * UDP보다 **속도가 느림**
  >
  > * 연속성보다는 **신뢰성**이 중요한 서비스에 사용 ex) 파일 전송

* TCP 서버의 특징

  * 서버 소켓은 연결만을 담당함

  * 연결과정에서 반환된 클라이언트 소켓은 데이터의 송수신에 사용됨

  * 서버와 클라이언트는 1대1로 연결

  * 스트림 전송으로 전송 데이터의 크기가 무제한

  * 패킷에 대한 응답을 해야하기 때문에(시간 지연, CPU 소모) 성능이 낮음

    * ```
      패킷이란?
      - 인터넷 내에서 데이터를 보내기 위한 경로배정(라우팅)을 효율적으로 하기 위해서 데이터를 여러 개의 조각들로 나누어 전송을 하는데 이때, 이 조각을 패킷이라고 함
      ```

  * Streaming 서비스에 불리함 (손실된 경우 재전송 요청을 하므로)

<br/>

## 2. UDP(User Datagram Protocol)

* 사용자 데이터그램 프로토콜(규약)

* **비연결형 프로토콜**

* 데이터를 데이터그램 단위로 처리하는 프로토콜

  * 데이터그램 : 독립적인 관계를 지니는 패킷

* 편지를 보내는 방식과 유사

* 특징

  > * 비연결형 서비스로 데이터그램 방식을 제공
  >   * 연결을 설정하고 해제하는 과정이 존재하지 않음
  >   * <img src = https://t1.daumcdn.net/cfile/tistory/9969973359FEB59309 width = 50%>
  > * 정보를 주고 받을 때 정보를 보내거나 받는다는 신호절차를 거치지 않음
  > * UDP헤더의 CheckSum 필드를 통해 최소한의 오류만 검출
  > * 신뢰성이 낮음
  >   * 데이터 전송에 대한 보장을 하지 않아 패킷 손실이 발생할 수 있음
  > * TCP보다 속도가 빠름
  >   * 혼잡제어를 하지 않기 때문
  > * 신뢰성보다는 **연속성**이 중요한 서비스에 사용 ex) 실시간 서비스(streaming)

* UDP 서버의 특징

  * UDP에는 연결 자체가 없음(connect 함수 불필요)
  * 소켓 대신 IP를 기반으로 데이터를 전송
  * 서버와 클라이언트는 1대1, 1대N, N대M 등으로 연결될 수 있음
  * 데이터그램(메세지) 단위로 전송, 그 크기는 65535바이트로 크기가 초과하면 잘라서 보냄
  * 흐름제어(flow control)가 없어서 패킷이 제대로 전송되었는지, 오류가 없는지 확인할 수 없음
  * 파일 전송과 같은 신뢰성이 필요한 서비스보다 성능이 중요시 되는 경우에 사용됨

<br/>

## 3. TCP vs UDP

#### 3-1. 공통점

* 포트 번호를 이용하여 주소를 지정
* 데이터 오류 검사를 위한 checksum 존재

#### 3-2. 차이점

|   프로토콜 종류    |        TCP         |            UDP            |
| :----------------: | :----------------: | :-----------------------: |
|     연결 방식      |   연결형 서비스    |      비연결형 서비스      |
| 혼잡제어, 흐름제어 | 혼잡제어, 흐름제어 | 혼잡제어, 흐름제어 지원 X |
|   패킷 교환 방식   |   가상 회선 방식   |      데이터그램 방식      |
|     전송 순서      |   전송 순서 보장   |  전송 순서 바뀔 수 있음   |
|   수신 여부 확인   |   수신 여부 확인   |     수신 여부 확인 X      |
|     통신 방식      |      1:1 통신      |  1:1 or 1:N or N:N 통신   |
|       신뢰성       |        높음        |           낮음            |
|        속도        |        느림        |           빠름            |

+ TCP 데이터 송신 과정
  + <img src = https://madplay.github.io/img/post/2018-02-04-network-tcp-udp-tcpip-2.png width= 48%>
+ UDP 데이터 송신 과정
  + ![img](https://madplay.github.io/img/post/2018-02-04-network-tcp-udp-tcpip-3.png)

## :page_with_curl: Reference

[[TCP/UDP] TCP와 UDP의 특징과 차이](https://mangkyu.tistory.com/15)

[TCP 와 UDP 차이를 자세히 알아보자](https://velog.io/@hidaehyunlee/TCP-%EC%99%80-UDP-%EC%9D%98-%EC%B0%A8%EC%9D%B4)

[TCP와 UDP 비교 정리](https://swalloow.tistory.com/77)

[Network - TCP 통신과 UDP 통신](https://hack-cracker.tistory.com/111)